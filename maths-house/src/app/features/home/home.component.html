<div class="home-container">
  <!-- Character message panel occupies its own row -->
  <div class="message-panel" *ngIf="!showStartup" [ngStyle]="vars">
    <div class="char">
      <img class="avatar" [src]="avatarImage" alt="Puf-Puf" />
      <div class="name">{{ characterName }}</div>
    </div>
    <div class="msg" [innerText]="gameMessage"></div>
  </div>

  <div class="stage" [ngStyle]="vars">
  <div class="house-wrap">
  <img class="house" [src]="media.houseImage" alt="Math House" [style.max-height]="vars['--house-max-height']" (error)="onImageError('house', media.houseImage, $event)" />
    

    <!-- Startup overlay -->
    <div class="startup-overlay" *ngIf="showStartup">
      <video #startupVideo class="startup-video" [src]="media.startupVideo" autoplay playsinline muted preload="auto"
        (ended)="onStartupEnded()" (error)="onVideoError($event)"></video>
      <audio #startupAudio [src]="media.startupAudio" preload="auto" (error)="onAudioError($event)"></audio>
      <button class="start-btn" *ngIf="autoplayBlocked" (click)="onUserStart()">Start</button>
    </div>

    <!-- Ground floor button -->
    <button class="hotzone ground-door" (click)="open('GroundFloor')" [disabled]="isLocked('GroundFloor')">
  <img class="hand hand-fade" [src]="media.handImage" alt="hand" [style.width]="vars['--hand-size']" (error)="onImageError('hand', media.handImage, $event)" />
    </button>

    <!-- First floor left/right: clickable even when locked -->
    <button class="hotzone first-left" (click)="open('FirstFloorLeft')" [attr.aria-label]="'First floor left ' + (isLocked('FirstFloorLeft') ? 'locked' : 'available')">
      <img *ngIf="isLocked('FirstFloorLeft')" class="lock" src="assets/images/lock.png" alt="locked" (error)="onImageError('lock-left', 'assets/images/lock.png', $event)" />
    </button>
    <button class="hotzone first-right" (click)="open('FirstFloorRight')" [attr.aria-label]="'First floor right ' + (isLocked('FirstFloorRight') ? 'locked' : 'available')">
      <img *ngIf="isLocked('FirstFloorRight')" class="lock" src="assets/images/lock.png" alt="locked" (error)="onImageError('lock-right', 'assets/images/lock.png', $event)" />
    </button>
  </div>
  </div>
</div>

<!-- Simple modal for locked floors -->
<div class="modal-overlay" *ngIf="lockedModal.visible" (click)="closeLockedModal()">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">Locked floor</div>
    <div class="modal-body">{{ lockedModal.message }}</div>
    <div class="modal-actions">
      <button class="modal-btn" (click)="closeLockedModal()">OK</button>
    </div>
  </div>
  </div>
